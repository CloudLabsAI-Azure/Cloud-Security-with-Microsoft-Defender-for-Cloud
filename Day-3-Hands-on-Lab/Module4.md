# Exercise 4: Advanced Alert Investigation with Microsoft Defender and Sentinel 

## Overview:

In this lab, you will learn how to integrate Microsoft Defender for Cloud with Microsoft Sentinel to enhance your security operations. You will investigate alerts generated by Defender for Cloud using Sentinel’s advanced analytics and automation capabilities. This integration helps unify cloud-native threat protection with AI-driven insights to streamline investigation and response processes.

## Estimated Duration: 75 Minutes

## Lab Objectives:

By the end of this lab, you will be able to:

- Task 1: Connect Microsoft Defender for Cloud with Microsoft Sentinel
- Task 2: Trigger a Sample Alert in Defender for Cloud
- Task 3: Investigate Alerts in Microsoft Sentinel
- Task 4: Automate Response with Sentinel Playbooks

### Task 1: Connect Microsoft Defender for Cloud with Microsoft Sentinel

1. Open the [Azure Portal](https://portal.azure.com).
2. Search for **Microsoft Sentinel**, and select the workspace to which you want to connect Defender for Cloud.
3. In Sentinel, go to **Content Hub**, and ensure **Microsoft Defender for Cloud** solution is installed.
4. Under **Settings > Data connectors**, search for **Microsoft Defender for Cloud**.
5. Click on the connector and follow the instructions to enable it (enable relevant checkboxes and save).

### Task 2: Trigger a Sample Alert in Defender for Cloud

1. In Azure Portal, navigate to **Microsoft Defender for Cloud**.
2. Go to **Workload protections** > **Virtual Machines**.
3. Deploy or use an existing VM and intentionally misconfigure security settings (e.g., open port 3389 to public).
4. Wait for an alert to be triggered by Defender for Cloud.

### Task 3: Investigate Alerts in Microsoft Sentinel

1. Open **Microsoft Sentinel** > your Log Analytics workspace.
2. Go to **Incidents** or **Hunting** > check for recent incidents triggered by Defender for Cloud.
3. Select an incident and explore **Entities**, **Investigation Graph**, and **Alert details**.
4. Use **Notebooks** or **Workbooks** to further analyze attack patterns or anomalies.

### Task 4: Automate Response with Sentinel Playbooks

1. In Sentinel, go to **Automation** > **Create** > **Playbook (Logic App)**.
2. Choose a blank template or start with a template like “**Block IP in NSG**”.
3. Configure the trigger (e.g., when an incident is created).
4. Add actions such as:

   * Sending an email
   * Blocking IP address
   * Disabling user account

5. Save and enable the playbook.

## Summary:

By completing this lab, you integrated **Microsoft Defender for Cloud** with **Microsoft Sentinel**, triggered alerts, analyzed them using Sentinel’s incident investigation features, and created an automated response to security threats using Logic Apps. This lab showcases how security teams can leverage cloud-native SIEM + XDR for efficient and intelligent threat response.

## You have successfully completed the lab